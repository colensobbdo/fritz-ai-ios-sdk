//
//  PoseLifting+Preprocessing.swift
//  FritzVision
//
//  Created by Christopher Kelly on 3/27/19.
//  Copyright Â© 2019 Fritz Labs Incorporated. All rights reserved.
//
import Foundation

/// Pose Normalization terms taken from training images.
class PosePreprocessing {

  static let std2d = [
    [0.0, 0.0],
    [8.85181741, 1.94945893],
    [12.722074, 24.263862],
    [18.23150051, 31.42929645],
    [8.88383237, 1.97204642],
    [15.60962568, 25.17316217],
    [17.37274738, 32.4846023],
    [13.35117541, 14.32435185],
    [13.75102442, 11.38676369],
    [21.451845, 15.03237294],
    [23.85288232, 24.80932754],
    [14.74898872, 11.26991502],
    [22.52664472, 15.54125162],
    [24.92060102, 26.47937569],
  ].map { CGPoint(x: $0[0], y: $0[1]) }

  static let mean2d = [
    [0.0, 0.0],
    [8.53037466, -1.1266127],
    [2.74521769, 32.38792775],
    [2.2507015, 74.1139578],
    [-8.68716254, 1.16377718],
    [-15.27672339, 34.50703294],
    [-11.27341745, 76.82299763],
    [-1.55439295, -57.58045724],
    [-8.67445419, -45.068727],
    [-18.51009913, -22.4811291],
    [-17.46182532, -15.524185],
    [9.78264151, -44.383631],
    [15.66041108, -22.91339672],
    [8.03459175, -19.918792],
  ].map { CGPoint(x: $0[0], y: $0[1]) }

  static let mean3d = [
    [0.0, 0.0, 0.0],
    [37.9660885, -6.17281622, 18.73827555],
    [8.69695574, 142.35795573, 104.55042268],
    [5.47544786, 333.92369452, 112.72929304],
    [-37.96594571, 6.17279507, -18.73822197],
    [-73.33489415, 152.45624067, 64.30883281],
    [-55.59105177, 344.91979704, 85.7836436],
    [-7.28974398, -251.25904732, -9.77404632],
    [-36.98402307, -192.05587649, -50.26325237],
    [-80.48541659, -94.85664267, -41.15628406],
    [-78.39720238, -68.57504638, 6.27181275],
    [43.1501862, -194.60061539, -6.35559996],
    [68.76019929, -104.89961127, 40.41780854],
    [33.45913629, -94.10069675, 67.13718394],
  ].map { Point3D(x: $0[0], y: $0[1], z: $0[2]) }

  static let std3d = [
    [0.0, 0.0, 0.0],
    [37.78526785, 9.52067173, 30.06156108],
    [57.84470454, 104.43934423, 81.03797683],
    [84.52998694, 131.25593607, 103.59558366],
    [37.78512794, 9.52063919, 30.0614553],
    [71.81610869, 109.57792136, 74.43013628],
    [79.73634099, 136.76436405, 102.85799378],
    [58.45712953, 57.14844964, 75.70963475],
    [60.12443965, 44.32850667, 69.84313114],
    [92.64164676, 62.56811597, 97.7525711],
    [102.79658187, 107.80085373, 108.84217567],
    [62.35022218, 46.30411074, 68.93880293],
    [96.69241954, 69.66459805, 95.71334603],
    [109.72699801, 118.36403163, 107.77347915],
  ].map { Point3D(x: $0[0], y: $0[1], z: $0[2]) }

  static let modelInputPartOrder: [HumanSkeleton] = [
    .leftHip,
    .leftKnee,
    .leftAnkle,
    .rightHip,
    .rightKnee,
    .rightAnkle,
    .nose,
    .rightShoulder,
    .rightElbow,
    .rightWrist,
    .leftShoulder,
    .leftElbow,
    .leftWrist,
  ]

}

typealias PoseLiftingPart = (
  part: HumanSkeleton,
  index: Int,
  mean2D: CGPoint,
  std2D: CGPoint,
  mean3D: Point3D,
  std3D: Point3D
)
